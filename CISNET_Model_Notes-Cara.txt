
LEGEND:
_________________________________________________________________________
pop(d , v , h , s , p , g , a , r)
d - disease
v - viral load
h - HPV types
s - HPV/Cervical cancer status
p - period of infection or cervical cancer status / vaccination history
g - gender
a - age
r - risk

States
h - HPV type(s)
s - HPV progression status

For d:
1 - HIV negative
2 - acute infection
3 - CD4 > 500 cells/uL
4 - CD4 500-350 cells/uL
5 - CD4 350-200 cells/uL
6 - CD4 <= 200 cells/uL
7 - HIV-negative, circumcised, and no PrEP (if g = 1) ; HIV-negative, dapivirine ring (if g = 2)
8 - HIV-negative, circumcised and on PrEP (if g = 1); HIV-negative, dapivirine ring & PrEP (if g = 2)
9 - HIV-negative, uncircumcised, and on PrEP (if g = 1); HIV-negative & PrEP (if g = 2)
10 - HIV-positive on ART

For v:
1 - acute infection
2 - VL < 1000 copies/mL (if d > 1) , 0 (if d = 1)
3 - VL 1000-10,000 copies/mL
4 - VL 10,000-50,000 copies/mL
5 - VL > 50,000 copies/mL
6 - HIV-positive on ART

For h:
1 - HPV Susceptible
2 - Infected with vaccine type hrHPV (16/18) (currently includes all hrHPV types)
3 - Infected with vaccine type hrHPV (non-16/18 or non-4v, 9v covered) (not currently used)
4 - Infected non-vaccine type hrHPV (other high risk) (not currently used)

For s:
1 - No precancer(h = 1) , infected (h >= 2)
2 - CIN1 (if h > 1)
3 - CIN2
4 - CIN3
5 - Cervical Cancer (Local)
6 - Cervical Cancer (Regional)
7 - Cervical Cancer (Distant)
8 - Hysterectomy
9 - Vaccinated
10 - Immune

For p:
1 - non-vaccinated (s = 1-8,10) , vaccinated and uninfected (s = 9)
2 - vaccinated, with subsequent vaccine type infection
3 - vaccinated, with subsequent non-vaccine type infection (not currently used)
4 - vaccinated, with vaccine type infection, and screened
5 - vaccinated, with non-vaccine type infection (not currently used), and screened
6 - non-vaccinated or vaccinated and uninfected, and screened

For g:
1 - Male
2 - Female

For a:
1- 0-4 age group
2- 5-9 
3- 10-14
4- 15-19
5- 20-24
6- 25-29
7- 30-34
8- 35-39
9- 40-44
10- 45-49
11- 50-54
12- 55-59
13- 60-64
14- 65-69
15- 70-74
16- 75-79

For r:
1 - Low risk
2 - Medium risk
3 - High risk
*risk is defined by the number of partners per year



NOTES:
____________________________________________________________________

hysterectomy --> not susceptible to infection

How to retrive values for each compartment
toInd(allcomb(d , v , h , s , p , g , a , r))
Each of the above variables can be a single number, e.g. "3", or a range of numbers, e.g. "2:5"



SCRIPTS AND FUNCTIONS USED TO PREPARE AND RUN THE MODEL:
_________________________________________________________________________

Run model:
1) mainCalibrated.m 
   - historical trends up to current year
   - loads parameters/indices/matrices from the \Params directory
     \Params\calibratedParams (most recent calibration & all parameters after Nick)
     \Params\general (this and below loaded due to changes since Nick)
     \Params\mixInfectIndices
     \Params\hivIndices
     \Params\hpvIndices
     \Params\ageRiskInds  
     \Params\ager
     \Params\vlAdvancer
     \Params\fertMat
     \Params\hivFertMats
     \Params\fertMat2
     \Params\hivFertMats2
     \Params\deathMat
     \Params\circMat
     \Params\circMat2
   - saves outputs to the \HHCoM_Results directory
     \HHCoM_Results\toNow
   - uses the following functions
     progressbar.m
     ode4xtra.m    
     hpvCCdet.m
     hpvScreen.m 
     mixInfect.m
     hiv2a.m
     calcDist.m
     bornAgeDieRisk.m
     hpvVaxSchool.m
     showResults.m
     - loads parameters 
       \Params\calibratedParams
       \Params\calibData (probably not needed)
       \Params\general
       \HHCoM_Results\toNow

2) simVaxCEA2.m 
   - vaccination scenarios & cost analysis
   - loads parameters from the \Params directory
     \Params\calibratedParams (most recent calibration & all parameters after Nick)
     \Params\general (this and below loaded due to changes since Nick)
     \Params\mixInfectIndices
     \Params\hivIndices
     \Params\hpvIndices
     \Params\ageRiskInds  
     \Params\ager
     \Params\vlAdvancer
     \Params\fertMat
     \Params\hivFertMats
     \Params\fertMat2
     \Params\hivFertMats2
     \Params\deathMat
     \Params\circMat
     \Params\circMat2
   - loads parameters from the \HHCoM_Results directory
     \HHCoM_Results\toNow
   - saves outputs to the \HHCoM_Results\Vaccine directory
     \HHCoM_Results\Vaccine\vaxSimResult or \vaxWaneSimResult
   - uses the following functions
     allcomb.m
     ode4xtra.m   
     hpvCCdet.m 
     hpvScreen.m 
     mixInfect.m
     hiv2a.m
     calcDist.m
     bornAgeDieRisk.m
     hpvVaxLmtd.m
     hpvVaxSchool.m
     hpvVaxCU.m
     parsave.m
     vaxCEA.m

Load and prepare parameters for the model (only need to run when input parameters or transition matrices are changed):
1) loadUp.m*** 
   - imports data from the following Excel spreadsheets in \Config directory 
     (data imported into model is highlighted in yellow)
     \Config\Population_data.xlsx (Demographics)
     \Config\HIV_parameters.xlsx (Protection, Disease Data)
     \Config\HPV_parameters.xlsx (HPV, Cervical Cancer, Screening and Treatment, CIN Transition
     \Config\Weights_costs.xlsx (Costs)
     \Config\Calibration_targets (Calibration)
   - imports data from the following .mat file 
     settings.mat
   - saves parameters in the \Params directory as .mat files
     \Params\popData
     \Params\HIVParams
     \Params\general
     \Params\mixInfectParams
     \Params\vlBeta
     \Params\hpvData
     \Params\cost_weights
     \Params\calibData
   - if uncommented, calculates indices using the following function
     calcInds.m
     - which saves parameters in the \Params directory as .mat files
       mixInfectIndices.mat
       hivIndices.mat
       hpvIndices.mat
       hpvTreatIndices.mat
       ageRiskInds.mat
       vaxInds.mat
   ***parameters in calibratedParams.m don't necessarily match those loaded in by loadUp.m so for now better just to change manually in code
     
2) makeMat.m** 
   - creates transition matrices using data from Excel spreadsheets             ????
   **if data used in transition matrices changes, makeMat.m must be ran again

3) prepCalibParams.m (out of date)
   - combines a bunch of parameter matrices (some calibrated, some previously loaded) into one
   - loads parameters from the \Params directory previously imported from Excel files  
   - loads calibrated paramters from .dat file
   - saves parameters in the \Params directory as .mat file
     \Params\calibratedParams

Calibrate model: (out of date)
?) quickCalibrateModel.m
   - uses the following functions
     calibrator.m
     - uses the following functions
       hpvCCdet.m
       mixInfect.m
       hiv2a.m
       bornAgeDieRisk.m
       likeFun.m

?) quickCalibrateModelHIV.m
   - uses the following functions
     calibratorHIV.m
     - uses the following functions
       hpvCCdet.m
       mixInfect.m
       hiv2a.m
       bornAgeDieRisk.m
       likeFun.m
